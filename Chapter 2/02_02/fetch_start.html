<!doctype html>
<html>
    <head>
        <title>Fetch API Example</title>
        <style type="text/css">
        </style>
        <link rel="stylesheet" href="../../style.css" />
    </head>
    <body>
        <h1>Using the Fetch API</h1>
        <div id="content">
            <p>The fetch API makes AJAX-style data requests easier to handle.</p>
            <p>Open the developer tools console to see the responses from the server.</p>
        </div>

        <script>
            window.addEventListener("load", function () {
                // TODO: Perform a regular GET operation
                fetch("https://httpbin.org/json").then(function(response) {
                  console.log("Content-type: ", response.headers.get("Content-Type"));
                  console.log("Redirected: ", response.redirected);
                  console.log("Status: ", response.status);
                  console.log("Status-text: ", response.statusText);
                  console.log("Response URL: ", response.url);

                  if(response.status == 200){
                    return  response.text();
                  }
                }).then(function (returnData){
                  console.log("Returned data: ", returnData);
                }).catch(function (error){
                  console.log("error", error);
                })
                // TODO: perform a POST function with data in the body
                fetch("https://httpbin.org/json", {
                  method: 'post',
                  body: 'foo=bar',
                  header: {
                    "x-custom-header" : "my custom value"
                  }
                }).then(function (response){
                  return response.text();
                }).then(function (returnData){
                  console.log("Returned post data: ", returnData);
                })
            });
        </script>
    </body>
</html>